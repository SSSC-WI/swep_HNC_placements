---
title: "Student placements in social services"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: scroll
---

```{r setup, include=FALSE}
library(flexdashboard)
```

```{r packages}
library(tidyverse)
library(rgdal)
library(sf)
library(leaflet)
library(DT)
library(glue)
library(plotly)
source("functions.R")
```





```{r read and clean, results = F}
df = read_csv("placements_clean.csv")
```


Summary
=======================================================================

About {padding=100}
-------------------------------------

```{r logo}
knitr::include_graphics("LOGO_pad.jpg")
``` 

### About

These data have been collected by the SSSC (https://www.sssc.uk.com/) to inform placement requirements on social services programmes accepted for registration by the SSSC.

Many thanks to the staff of Scotland's colleges for submitting data and making this work possible.

### Explanation

Not all courses require student placement.
The overall number of students enrolled is shown on as "All Students", otherwise enrolled student numbers are for those courses requiring a placement.

The description of course options is:

* Option 1: the student has a placement or is employed in the sector.
* Option 2: the student requires the college to find them a placement.
* Option 3: the student is planning on attending university after their course, and so a practical placement is not required at this stage.


Value boxes
-------------------------------------

### Colleges

```{r vb colleges}
length(unique(df$centre_name)) %>% 
  valueBox(icon = "fa-university")
```

### All Students

```{r vb students}
sum(df$students) %>% 
  valueBox(icon = "fa-graduation-cap")
```

### Students on practical courses

```{r vb students on practical}
sum(df$students[df$placement_req == "yes"]) %>% 
  valueBox(icon = "fa-graduation-cap")
```

### Placements required

```{r vb placements needed}
sum(df$not_placed, na.rm = T) %>% 
  valueBox(icon = "fa-question-circle")
```

### Placed

```{r vb placed gauge}
placed_gauge(df)
```


By College
=======================================================================


### Map of students requiring placements

```{r map}
placements_map(df)
```

### What proportion of students have placements?

```{r proportion}
x = proportion_plot(df)

ggplotly(x)
```


HNC Childhood Practice
=======================================================================

Column {data-width=150}
-------------------------------------

```{r HNC CP subset}
df_subset = df %>% 
  filter(course == "HNC Childhood Practice")
```

### Colleges

```{r HNC CP colleges}
length(unique(df_subset$centre_name)) %>% 
  valueBox(icon = "fa-university")
```

### All Students

```{r HNC CP students}
sum(df_subset$students) %>% 
  valueBox(icon = "fa-graduation-cap")
```

### Students on practical courses

```{r HNC CP students on practical}
sum(df_subset$students[df_subset$placement_req == "yes"]) %>% 
  valueBox(icon = "fa-graduation-cap")
```

### Placements required

```{r HNC CP placements needed}
sum(df_subset$not_placed, na.rm = T) %>% 
  valueBox(icon = "fa-question-circle")
```

### Placed

```{r HNC CP placed gauge}
placed_gauge(df_subset)
```


Column {data-width=500}
-------------------------------------

### Map of students requiring placements

```{r map HNC CP}
placements_map(df_subset)
```


### What proportion of students have placements?

```{r proportion HNC CP}
x = proportion_plot(df_subset)

ggplotly(x)
```


Data Table
=======================================================================

```{r summary table}
df %>%
  select(-students_log, -not_placed_log, -easting, -northing,
         data_updated = start_time) %>% 
  mutate(percent_placed = scales::percent((students - not_placed) / students, 1)) %>% 
  DT::datatable(extensions = 'Buttons',
                filter = 'top',
                options = list(dom = 'Blfrtip',
                               buttons = c('copy', 'csv'),
                               lengthMenu = list(c(15, 25, 50, -1),
                                             c(15, 25, 50, "All"))))
```
